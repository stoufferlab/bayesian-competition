}
all_posterior <- cbind(post,growth,env_growth)
return(all_posterior)
}
vero_post<-(LAW_vero, fun= law_growth, si, gi, exp_param=1)
vero_post<-posterior_parameters(LAW_vero, fun= law_growth, si, gi, exp_param=1)
trcy_post<-posterior_parameters(LAW_trcy, fun= law_growth, sj, gj, exp_param=1)
i\
i<-1
alpha  <- alpha_matrix(vero_post[i,],trcy_post[i,],gi,gj,env)
alpha  <- alpha_matrix(vero_post[i,],trcy_post[i,],gi,gj,0)
alpha
r1 <- vero_post$growth[i]
r2 <- trcy_post$growth[i]
omega       <-Omega(alpha)
omega
feasibility <-test_feasibility(alpha,c(r1,r2))
theta       <-theta(alpha,c(r1,r2))
feasibility
theta
posterior_feasibility<-function(vero_post,trcy_post,si,sj,gi,gj,env){
num_posterior<- identical(nrow(vero_post),nrow(trcy_post))
if(num_posterior){
omega_results       <-c()
feasibility_results <-c()
growth_results      <-c()
theta_results       <-c()
for( i in 1:nrow(vero_post)){
#we get the corresponding posterior values, vero first, trcy second, gi (vero), gj(trcy)
alpha  <- alpha_matrix(vero_post[i,],trcy_post[i,],gi,gj,env)
if(env){
r1 <- vero_post$env_growth[i]
r2 <- trcy_post$env_growth[i]
}else{
r1 <- vero_post$growth[i]
r2 <- trcy_post$growth[i]
}
#And estimate the feasability domain
omega       <-Omega(alpha)
feasibility <-test_feasibility(alpha,c(r1,r2))
theta       <-theta(alpha,c(r1,r2))
# #we save it
omega_results       <-c(omega_results,omega)
feasibility_results <-c(feasibility_results, feasibility)
theta_results       <-c(theta_results,theta)
}
pp<- cbind(omega_results,feasibility_results,theta_results)
pp<-as.data.frame(pp)
return(pp)
}else{warning("Posterior distributions are not the same length")}
}
posterior_feasibility(vero_post, trcy_post, si, sj,gi,gj)
posterior_feasibility(vero_post, trcy_post, si, sj,gi,gj, env = 0)
#toolbox for example BEV competition
require(brms)
require(tidyverse)
require(ggplot2)
require(rethinking)
source("code/feasibility_toolbox.R")
source("code/growth_rates.R")
}
}
posterior_feasibility<-function(vero_post,trcy_post,si,sj,gi,gj,env){
num_posterior<- identical(nrow(vero_post),nrow(trcy_post))
if(num_posterior){
omega_results       <-c()
feasibility_results <-c()
growth_results      <-c()
theta_results       <-c()
for( i in 1:nrow(vero_post)){
#we get the corresponding posterior values, vero first, trcy second, gi (vero), gj(trcy)
alpha  <- alpha_matrix(vero_post[i,],trcy_post[i,],gi,gj,env)
if(env){
r1 <- vero_post$env_growth[i]
r2 <- trcy_post$env_growth[i]
}else{
r1 <- vero_post$growth[i]
r2 <- trcy_post$growth[i]
}
#And estimate the feasability domain
omega       <-Omega(alpha)
feasibility <-test_feasibility(alpha,c(r1,r2))
theta       <-theta(alpha,c(r1,r2))
# #we save it
omega_results       <-c(omega_results,omega)
feasibility_results <-c(feasibility_results, feasibility)
theta_results       <-c(theta_results,theta)
}
pp<- cbind(omega_results,feasibility_results,theta_results)
pp<-as.data.frame(pp)
return(pp)
}else{warning("Posterior distributions are not the same length")}
}
posterior_feasibility(vero_post, trcy_post, si, sj,gi,gj, env = 0)
fes<-posterior_feasibility(vero_post, trcy_post, si, sj,gi,gj, env = 0)
hist(fes$omega_results)
hist(fes$feasibility_results)
theta values and feasibility for each row of the posterior.
feasibility_wrapper<-function(vero_model,vero_function, vero_exp,trcy_model,trcy_function,trcy_exp,env){
gi<-.372
si<-.556
gj<-.258
sj<-.033
vero_post<- posterior_parameters(vero_model, fun = vero_function, si, gi, exp_param = vero_exp)
trcy_post<- posterior_parameters(trcy_model, fun= trcy_function, sj,  gj, exp_param = trcy_exp)
post <- posterior_feasibility(vero_post, trcy_post,si,sj,gi,gj, env = env)
return(post)
}
feasibility_wrapper<-function(vero_model,vero_function, vero_exp,trcy_model,trcy_function,trcy_exp,env){
gi<-.372
si<-.556
gj<-.258
sj<-.033
vero_post<- posterior_parameters(vero_model, fun = vero_function, si, gi, exp_param = vero_exp)
trcy_post<- posterior_parameters(trcy_model, fun= trcy_function, sj,  gj, exp_param = trcy_exp)
post <- posterior_feasibility(vero_post, trcy_post,si,sj,gi,gj, env = env)
return(post)
}
feasibility_wrapper(vero_model = LAW_vero , vero_function = law_growth , vero_exp = 1, trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0)
LAW_LAW_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0)
source("code/theta_figure.R")
LAW_LAW_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0)
LAW_LAW_0
RC_trcy <- readRDS("~/bayesian-competition/RC_trcy.RDS")
LAW_RC_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0)
RC_trcy <- readRDS("~/bayesian-competition/RC_trcy.RDS")
LV_trcy <- readRDS("~/bayesian-competition/LV_trcy.RDS")
#toolbox for example BEV competition
require(brms)
source("code/feasibility_toolbox.R")
source("code/growth_rates.R")
posterior_parameters<-function(model, fun, s ,g, exp_param){
post        <- posterior_samples(model)
lambda      <- exp(post$b_lambda_Intercept)
lambda_env  <- exp(lambda + post$b_lambda_env)
if(exp_param){
b           <- post$b_beta_Intercept
b_env       <- post$b_beta_env
growth      <- fun(s,g,lambda,b)
env_growth  <- fun(s,g,lambda_env,b_env)
}else{
growth     <- fun(s,g,lambda)
env_growth <- fun(s,g,lambda_env)
}
all_posterior <- cbind(post,growth,env_growth)
return(all_posterior)
}
#function to generate an alpha matrix based on one row of the posterior for each species. env is a binary that tells it if to take into consideration the environmental values of alpha
alpha_matrix <- function(vero_row, trcy_row, gi,gj, env){
# vero_row <- as.list(vero_row)
# trcy_row <- as.list(trcy_row)
#if env, then alphas are alpha + alpha_env
if(env){
alpha11 <- vero_row$b_alphaii_Intercept + vero_row$b_alphaii_env
alpha21 <- trcy_row$b_alphaij_Intercept + trcy_row$b_alphaij_env
alpha12 <- vero_row$b_alphaij_Intercept + vero_row$b_alphaij_env
alpha22 <- trcy_row$b_alphaii_Intercept + trcy_row$b_alphaii_env
alpha   <- matrix( c(alpha11,alpha21,alpha12,alpha22) ,ncol=2,nrow=2)
alpha   <- sweep (alpha,MARGIN=2,STAT=c(gi,gj),FUN="*")
}else{
alpha11 <- vero_row$b_alphaii_Intercept
alpha21 <- trcy_row$b_alphaij_Intercept
alpha12 <- vero_row$b_alphaij_Intercept
alpha22 <- trcy_row$b_alphaii_Intercept
alpha   <- matrix( c(alpha11,alpha21,alpha12,alpha22) ,ncol=2,nrow=2)
alpha   <- sweep (alpha,MARGIN=2,STAT=c(gi,gj),FUN="*")
}
return(alpha)
}
gi<-.372
si<-.556
gj<-.258
sj<-.033
vero_post<-posterior_parameters(model = LAW_vero, fun = law_growth, si, gi, exp_param = 1 )
LAW_vero <- readRDS("~/bayesian-competition/LAW_vero.RDS")
vero_post<-posterior_parameters(model = LAW_vero, fun = law_growth, si, gi, exp_param = 1 )
vero_post
trcy_post<-posterior_parameters(model = RC_trcy, fun = ricker_growth, sj, gj, exp_param = 0 )
trcy_post<-posterior_parameters(model = RC_trcy, fun = ricker_growth, sj, gj, exp_param = 1)
trcy_post<-posterior_parameters(model = RC_trcy, fun = ricker_growth, sj, gj, exp_param = 0)
trcy_post
i<-
1
(vero_post[i,]
)
(trcy_post[i,])
alpha  <- alpha_matrix(vero_post[i,],trcy_post[i,],gi,gj,env)
alpha  <- alpha_matrix(vero_post[i,],trcy_post[i,],gi,gj,env=0)
alpha
posterior_feasibility<-function(vero_post,trcy_post,si,sj,gi,gj,env){
num_posterior<- identical(nrow(vero_post),nrow(trcy_post))
if(num_posterior){
omega_results       <-c()
feasibility_results <-c()
growth_results      <-c()
theta_results       <-c()
for( i in 1:nrow(vero_post)){
#we get the corresponding posterior values, vero first, trcy second, gi (vero), gj(trcy)
alpha  <- alpha_matrix(vero_post[i,],trcy_post[i,],gi,gj,env)
print(alpha)
if(env){
r1 <- vero_post$env_growth[i]
r2 <- trcy_post$env_growth[i]
}else{
r1 <- vero_post$growth[i]
r2 <- trcy_post$growth[i]
}
#And estimate the feasability domain
omega       <-Omega(alpha)
feasibility <-test_feasibility(alpha,c(r1,r2))
theta       <-theta(alpha,c(r1,r2))
# #we save it
omega_results       <-c(omega_results,omega)
feasibility_results <-c(feasibility_results, feasibility)
theta_results       <-c(theta_results,theta)
}
pp<- cbind(omega_results,feasibility_results,theta_results)
pp<-as.data.frame(pp)
return(pp)
}else{warning("Posterior distributions are not the same length")}
}
posterior_feasibility(vero_post,trcy_post,si,sj,gi,gj,env = 0)
aa<-matrix(c( 0.902674974,0.007317403,1.48942539,0.01207386))
aa
aa<-matrix(c( 0.902674974,0.007317403,1.48942539,0.01207386), nrow = 2)
aa
Omega(aa)
?solve
Omega <- function(alpha){
n <- nrow(alpha)
Sigma <-solve(t(alpha) %*% alpha, tol =  1.88129e-25 )
d <- pmvnorm(lower = rep(0,n), upper = rep(Inf,n), mean = rep(0,n), sigma = Sigma)
out <- log10(d[1]) + n * log10(2)
return( d[1]^(1 / n))
}
Omega(aa)
posterior_feasibility(vero_post,trcy_post,si,sj,gi,gj,env = 0)
source("code/theta_figure.R")
BEV_vero <- readRDS("~/bayesian-competition/BEV_vero.RDS")
BEV_trcy <- readRDS("~/bayesian-competition/BEV_trcy.RDS")
RC_vero <- readRDS("~/bayesian-competition/RC_vero.RDS")
RC_trcy <- readRDS("~/bayesian-competition/RC_trcy.RDS")
LAW_vero <- readRDS("~/bayesian-competition/LAW_vero.RDS")
LAW_trcy <- readRDS("~/bayesian-competition/LAW_trcy.RDS")
#BEVERTON HOLT - BEVERTON HOLT
#
BEV_BEV_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0)
Omega <- function(alpha){
n <- nrow(alpha)
Sigma <-solve(t(alpha) %*% alpha, tol =  1.88129e-25 )
d <- pmvnorm(lower = rep(0,n), upper = rep(Inf,n), mean = rep(0,n), sigma = Sigma)
out <- log10(d[1]) + n * log10(2)
return( d[1]^(1 / n))
}
source("code/theta_figure.R")
BEV_vero <- readRDS("~/bayesian-competition/BEV_vero.RDS")
BEV_trcy <- readRDS("~/bayesian-competition/BEV_trcy.RDS")
RC_vero <- readRDS("~/bayesian-competition/RC_vero.RDS")
RC_trcy <- readRDS("~/bayesian-competition/RC_trcy.RDS")
LAW_vero <- readRDS("~/bayesian-competition/LAW_vero.RDS")
LAW_trcy <- readRDS("~/bayesian-competition/LAW_trcy.RDS")
#BEVERTON HOLT - BEVERTON HOLT
#
BEV_BEV_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0)
BEV_BEV_0
RC_BEV_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0)
RC_BEV_0
BEV_RC_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0)
#
BEV_BEV_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0)
# BEV_BEV_1 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 1)
##  RICKER - BEVERTON HOLT
RC_BEV_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0)
#
# RC_BEV_1 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 1)
#
#
#BEVERTON  HOLT - RICKER
BEV_RC_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0)
#
# BEV_RC_1 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 1)
##  RICKER - RICKER
RC_RC_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0)
# RC_RC_1 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 1)
##### LAW - BEVERTON HOLT
LAW_BEV_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0)
#
# LAW_BEV_1 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 1)
#### LAW - RICKER
LAW_RC_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0)
# LAW_RC_1 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 1)
#
##### BEVERTON -LAw
BEV_LAW_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0)
# BEV_LAW_1 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 1)
##  RICKER - LAW
RC_LAW_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0)
#
# RC_LAW_1 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 1)
#
########### LAW - LAW
LAW_LAW_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0)
# LAW_LAW_1 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 1)
#
pdf(file="omega.pdf", width = 14)
grid.arrange(BEV_BEV_0, RC_BEV_0, LAW_BEV_0,
BEV_RC_0,  RC_RC_0,  LAW_RC_0,
BEV_LAW_0, RC_LAW_0, LAW_LAW_0,
ncol=3, nrow=3)
dev.off()
LV_vero <- readRDS("~/bayesian-competition/LV_vero.RDS")
LV_trcy <- readRDS("~/bayesian-competition/LV_trcy.RDS")
LV_trcy
plot(LV_trcy)
source("code/theta_figure.R")
BEV_vero <- readRDS("~/bayesian-competition/BEV_vero.RDS")
BEV_trcy <- readRDS("~/bayesian-competition/BEV_trcy.RDS")
RC_vero <- readRDS("~/bayesian-competition/RC_vero.RDS")
RC_trcy <- readRDS("~/bayesian-competition/RC_trcy.RDS")
LAW_vero <- readRDS("~/bayesian-competition/LAW_vero.RDS")
LAW_trcy <- readRDS("~/bayesian-competition/LAW_trcy.RDS")
LV_vero <- readRDS("~/bayesian-competition/LV_vero.RDS")
LV_trcy <- readRDS("~/bayesian-competition/LV_trcy.RDS")
BEV_BEV_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0, title = "Beverton-Beverton")
BEV_BEV_0
BEV_BEV_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0, title = "Beverton-Holt & Beverton-Holt")
BEV_BEV_0
BEV_BEV_1 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 1,  title = "Beverton-Holt & Beverton-Holt")
BEV_BEV_1
RC_BEV_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0,  title = "Ricker & Beverton-Holt")
RC_BEV_0
RC_BEV_1 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 1,  title = "Ricker & Beverton-Holt")
#
RC_BEV_1
BEV_RC_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Beverton-Holt & Ricker")
BEV_RC_0
ricker_growth, trcy_exp = 0, env = 1,  title = "Beverton-Holt & Ricker")
BEV_RC_1 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 1,  title = "Beverton-Holt & Ricker")
BEV_RC_1
RC_RC_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Ricker & Ricker")
RC_RC+0
RC_RC_0
RC_RC_1 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 1,  title = "Ricker & Ricker")
RC_RC_1
LAW_BEV_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0,  title = "Law & Beverton-Holt")
LAW_BEV_0
LAW_BEV_1 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 1,  title = "Law & Beverton-Holt")
LAW_BEV_1
LAW_RC_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Law & Ricker")
LAW_RC_1 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 1,  title = "Law & Ricker")
LAW_RC_0
BEV_LAW_1 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 1,  title = "Beverton-Holt & Law")
LAW_RC_1
RC_LAW_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Ricker & Law",)
RC_LAW_1 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 1,  title = "Ricker & Law")
RC_LAW_0
RC_LAW_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Ricker & Law",)
RC_LAW_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Ricker & Law")
RC_LAW_0
LAW_LAW_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Law & Law")
LAW_LAW_1 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 1,  title = "Law & Law")
LAW_LAW_0
LAW_LAW_1
LV_BEV_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = BV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0,  title = "Law & Law")
LV_BEV_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0,  title = "Law & Law")
LV_BEV_0
LV_BEV_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Lotka & Ricker")
LV_BEV_0
LV_BEV_1 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 1,  title = "Lotka & Ricker")
LV_BEV_1
LV_LAW_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Lotka & LAW")
LV_LAW_0
LV_LAW_1 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 1,  title = "Lotka & LAW")
LV_LAW_1
LV_LAW_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Lotka & Lotka")
LV_LAW_0
LV_LAW_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Lotka & LAW")
LV_LV_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Lotka & Lotka")
LV_LV_0
LV_LV_0
BEV_LV_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = beverton_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Lotka & Lotka")
BEV_LV_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Lotka & Lotka")
BEV_LV_0
BEV_LV_1 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 1,  title = "Lotka & Lotka")
BEV_LV_1
BEV_LV_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Beverton-Holt & Lotka")
BEV_LV_1 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 1,  title = "Beverton-Holt & Lotka")
RC_LV_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Ricker & Lotka")
RC_LV_1 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 1,  title = "Ricker & Lotka")
RC_LV_1
RC_LV_0
RC_LV_1
RC_LV_0
LAW_LV_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Ricker & Lotka")
LAW_LV_0
LAW_LV_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "LAW & Lotka")
LAW_LV_1 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 1,  title = "LAW & Lotka")
LAW_LV_0
LAW_LV_1
LV_RC_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Lotka & Ricker")
LV_RC_1 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 1,  title = "Lotka & Ricker")
source("code/theta_figure.R")
BEV_vero <- readRDS("~/bayesian-competition/BEV_vero.RDS")
BEV_trcy <- readRDS("~/bayesian-competition/BEV_trcy.RDS")
RC_vero <- readRDS("~/bayesian-competition/RC_vero.RDS")
RC_trcy <- readRDS("~/bayesian-competition/RC_trcy.RDS")
LAW_vero <- readRDS("~/bayesian-competition/LAW_vero.RDS")
LAW_trcy <- readRDS("~/bayesian-competition/LAW_trcy.RDS")
LV_vero <- readRDS("~/bayesian-competition/LV_vero.RDS")
LV_trcy <- readRDS("~/bayesian-competition/LV_trcy.RDS")
#BEVERTON HOLT - BEVERTON HOLT
#
BEV_BEV_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0, title = "Beverton-Holt & Beverton-Holt")
##  RICKER - BEVERTON HOLT
RC_BEV_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0,  title = "Ricker & Beverton-Holt")
#BEVERTON  HOLT - RICKER
BEV_RC_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Beverton-Holt & Ricker")
##  RICKER - RICKER
RC_RC_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Ricker & Ricker")
##### LAW - BEVERTON HOLT
LAW_BEV_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0,  title = "Law & Beverton-Holt")
#### LAW - RICKER
LAW_RC_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Law & Ricker")
##### BEVERTON -LAw
BEV_LAW_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Beverton-Holt  & Law")
##  RICKER - LAW
RC_LAW_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Ricker & Law")
########### LAW - LAW
LAW_LAW_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Law & Law")
############## LOTKA - BEV
LV_BEV_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0,  title = "Lotka & Beverton-Holt")
#### LOTKA-RC
LV_RC_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Lotka & Ricker")
#### LOTKA -LAW
LV_LAW_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Lotka & LAW")
### LOTKA -LOTKA
LV_LV_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Lotka & Lotka")
###BEVERTON - LOTKA
BEV_LV_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Beverton-Holt & Lotka")
#### RICKER - LOTKA
RC_LV_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Ricker & Lotka")
##### LAW - LOTKA
LAW_LV_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "LAW & Lotka")
pdf(file="omega.pdf", width = 14)
grid.arrange(BEV_BEV_0, RC_BEV_0, LAW_BEV_0, LV_BEV_0,
BEV_RC_0,  RC_RC_0,  LAW_RC_0,  LV_RC_0,
BEV_LAW_0, RC_LAW_0, LAW_LAW_0, LV_LAW_0,
BEV_LV_0,  RC_LV_0,  LAW_LAW_0, LV_LV_0,
ncol=4, nrow=4)
dev.off()
source("code/theta_figure.R")
#
BEV_BEV_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0, title = "Beverton-Holt & Beverton-Holt")
##  RICKER - BEVERTON HOLT
RC_BEV_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0,  title = "Ricker & Beverton-Holt")
#BEVERTON  HOLT - RICKER
BEV_RC_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Beverton-Holt & Ricker")
##  RICKER - RICKER
RC_RC_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Ricker & Ricker")
##### LAW - BEVERTON HOLT
LAW_BEV_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0,  title = "Law & Beverton-Holt")
#### LAW - RICKER
LAW_RC_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Law & Ricker")
##### BEVERTON -LAw
BEV_LAW_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Beverton-Holt  & Law")
##  RICKER - LAW
RC_LAW_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Ricker & Law")
########### LAW - LAW
LAW_LAW_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Law & Law")
############## LOTKA - BEV
LV_BEV_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = BEV_trcy, trcy_function = bev_growth, trcy_exp = 0, env = 0,  title = "Lotka & Beverton-Holt")
#### LOTKA-RC
LV_RC_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = RC_trcy, trcy_function = ricker_growth, trcy_exp = 0, env = 0,  title = "Lotka & Ricker")
#### LOTKA -LAW
LV_LAW_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = LAW_trcy, trcy_function = law_growth, trcy_exp = 1, env = 0,  title = "Lotka & Law")
### LOTKA -LOTKA
LV_LV_0 <-make_figure_theta(vero_model =  LV_vero, vero_function = lotka_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Lotka & Lotka")
###BEVERTON - LOTKA
BEV_LV_0 <-make_figure_theta(vero_model =  BEV_vero, vero_function = bev_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Beverton-Holt & Lotka")
#### RICKER - LOTKA
RC_LV_0 <-make_figure_theta(vero_model =  RC_vero, vero_function = ricker_growth, vero_exp = 0 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Ricker & Lotka")
##### LAW - LOTKA
LAW_LV_0 <-make_figure_theta(vero_model =  LAW_vero, vero_function = law_growth, vero_exp = 1 , trcy_model = LV_trcy, trcy_function = lotka_growth, trcy_exp = 0, env = 0,  title = "Law & Lotka")
pdf(file="omega.pdf", width = 14)
grid.arrange(BEV_BEV_0, RC_BEV_0, LAW_BEV_0, LV_BEV_0,
BEV_RC_0,  RC_RC_0,  LAW_RC_0,  LV_RC_0,
BEV_LAW_0, RC_LAW_0, LAW_LAW_0, LV_LAW_0,
BEV_LV_0,  RC_LV_0,  LAW_LV_0, LV_LV_0,
ncol=4, nrow=4)
dev.off()
cc<-function(m1,m2,m3,m4){
m1<-add_criterion(m1, "waic")
m2<-add_criterion(m2, "waic")
m3<-add_criterion(m3, "waic")
m4<-add_criterion(m4, "waic")
w<-loo_compare(m1,m2,m3,m4,criterion="waic")
print(w)
m<-model_weights(m1,m2,m3,m4,weights="waic")
print(m)
}
cc(BEV_vero, RC_vero, LAW_vero, LV_vero)
76+15+8
cc(BEV_trcy, RC_trcy, LAW_trcy, LV_trcy)
84+16
aa<- matrix(c(0.902674974, 1.48942539,
0.007317403, 0.01207386), nrow=2)
aa
aa<- matrix(c(0.902674974, 1.48942539,
0.007317403, 0.01207386), nrow=2, byrow = T)
AA
aa
aa[,1]/aa[,2]
