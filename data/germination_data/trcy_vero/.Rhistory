rm(list = ls())
####bring in germiantion data
trcy_vero<-read_csv("data/trcy_vero.csv") %>%
dplyr::select(species, plot, light_treatment = `light/ dark`, plate_number = 'plate #',
num_seeds = '# seeds', emerged_inviable = 'emerged-inviable',
nongerm_filled = 'nongerminant-filled', nongerm_unfilled = 'nongerminant-unfilled',
no_radical = 'cotyledons only',
week_1 = 'week 1', week_2 = 'week 2', week_3 = 'week 3', week_4 = 'week 4', week_5 = 'week 5', cut_test_performed) %>%
dplyr::mutate(prop_germ = week_5/num_seeds)
library(tidyverse)
####bring in germiantion data
trcy_vero<-read_csv("data/trcy_vero.csv") %>%
dplyr::select(species, plot, light_treatment = `light/ dark`, plate_number = 'plate #',
num_seeds = '# seeds', emerged_inviable = 'emerged-inviable',
nongerm_filled = 'nongerminant-filled', nongerm_unfilled = 'nongerminant-unfilled',
no_radical = 'cotyledons only',
week_1 = 'week 1', week_2 = 'week 2', week_3 = 'week 3', week_4 = 'week 4', week_5 = 'week 5', cut_test_performed) %>%
dplyr::mutate(prop_germ = week_5/num_seeds)
####seed fill data
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")%>%
mutate(percentage.filled=((no.seeds.visible-no.seeds.unfilled)/no.seeds.visible))%>%
select(plot, species,no.seeds.visible,no.seeds.unfilled,percentage.filled)
#####calculate the point estiamte and CI for trcy seed fill first
trcy.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Trachymene cyanopetala",])
####plogis back-transform point estimate + and - standard error
trcy.mean.fill<-plogis(3.4534)
library(lme4)
####bring in germiantion data
trcy_vero<-read_csv("data/trcy_vero.csv") %>%
dplyr::select(species, plot, light_treatment = `light/ dark`, plate_number = 'plate #',
num_seeds = '# seeds', emerged_inviable = 'emerged-inviable',
nongerm_filled = 'nongerminant-filled', nongerm_unfilled = 'nongerminant-unfilled',
no_radical = 'cotyledons only',
week_1 = 'week 1', week_2 = 'week 2', week_3 = 'week 3', week_4 = 'week 4', week_5 = 'week 5', cut_test_performed) %>%
dplyr::mutate(prop_germ = week_5/num_seeds)
####seed fill data
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")%>%
mutate(percentage.filled=((no.seeds.visible-no.seeds.unfilled)/no.seeds.visible))%>%
select(plot, species,no.seeds.visible,no.seeds.unfilled,percentage.filled)
#####calculate the point estiamte and CI for trcy seed fill first
trcy.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Trachymene cyanopetala",])
####plogis back-transform point estimate + and - standard error
trcy.mean.fill<-plogis(3.4534)
trcy.fill.lower.ci<-plogis(3.4534-0.2118)
trcy.fill.upper.ci<-plogis(3.4534+0.2118)
#####calculate the point estiamte and CI for vero seed fill next
vero.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Velleia rosea",])
####plogis back-transform point estimate + and - standard error
vero.mean.fill<-plogis(3.3311)
vero.fill.lower.ci<-plogis(3.3311-0.2343)
vero.fill.upper.ci<-plogis(3.3311+0.2343)
###join fill to germination
trcy_vero<-left_join(trcy_vero, select(trcy_vero_fill,plot, species, percentage.filled,no.seeds.visible,no.seeds.unfilled))
###adjust the number of seeds in petri dishes by plot-specific fill rates
trcy_vero$adjusted.num.seeds=round(trcy_vero$num_seeds*trcy_vero$percentage.filled, digits=0)
#####function to bump up the adjusted seeds if high seed fill in xray conflicted with the adjusted number of seeds in petri dish
trcy_vero$adjusted.num.seeds<-ifelse(with(trcy_vero, adjusted.num.seeds-no_radical-emerged_inviable-week_5)<0, with(trcy_vero, no_radical+emerged_inviable+week_5), trcy_vero$adjusted.num.seeds)
#####first just calculate the proportion of germination in each petri dish
trcy_vero$prop_germ<-trcy_vero$week_5/(trcy_vero$adjusted.num.seeds-trcy_vero$no_radical-trcy_vero$emerged_inviable)
#####just extract the treatment and plot where species germianted best (i.e light or dark for each plot)
higher.germ<-trcy_vero%>%
group_by(plot,species)%>%
slice(which.max(prop_germ))
#####calculate the point estiamte and CI for trcy gemriantion first
trcy.germ<-glmer(cbind(week_5, ((adjusted.num.seeds-no_radical-emerged_inviable)-week_5)) ~1 + (1|plate_number), family=binomial, higher.germ[higher.germ$species=="Trachymene cyanopetala",])
####plogis back-transform point estimate + and - standard error
trcy.mean.germ<-plogis(-0.1025)
trcy.germ.lower.ci<-plogis(-0.1025-0.2442)
trcy.germ.upper.ci<-plogis(-0.1025+0.2442)
#####calculate the point estiamte and CI for vero gemriantion second
vero.germ<-glmer(cbind(week_5, ((adjusted.num.seeds-no_radical-emerged_inviable)-week_5)) ~1 + (1|plate_number), family=binomial, higher.germ[higher.germ$species=="Velleia rosea",])
####plogis back-transform point estimate + and - standard error
vero.mean.germ<-plogis(3.2910)
vero.germ.lower.ci<-plogis(3.2910-0.4407)
vero.germ.upper.ci<-plogis(3.2910+0.4407)
rm(list = ls())
library(tidyverse)
library(lme4)
####bring in germiantion data
trcy_vero<-read_csv("data/trcy_vero.csv") %>%
dplyr::select(species, plot, light_treatment = `light/ dark`, plate_number = 'plate #',
num_seeds = '# seeds', emerged_inviable = 'emerged-inviable',
nongerm_filled = 'nongerminant-filled', nongerm_unfilled = 'nongerminant-unfilled',
no_radical = 'cotyledons only',
week_1 = 'week 1', week_2 = 'week 2', week_3 = 'week 3', week_4 = 'week 4', week_5 = 'week 5', cut_test_performed) %>%
dplyr::mutate(prop_germ = week_5/num_seeds)
trcy_vero
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")%>%
mutate(percentage.filled=((no.seeds.visible-no.seeds.unfilled)/no.seeds.visible))%>%
select(plot, species,no.seeds.visible,no.seeds.unfilled,percentage.filled)
trcy_vero_fill
trcy.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Trachymene cyanopetala",])
trcy.fill
rm(list = ls())
library(tidyverse)
library(lme4)
####bring in germiantion data
trcy_vero<-read_csv("data/trcy_vero.csv") %>%
dplyr::select(species, plot, light_treatment = `light/ dark`, plate_number = 'plate #',
num_seeds = '# seeds', emerged_inviable = 'emerged-inviable',
nongerm_filled = 'nongerminant-filled', nongerm_unfilled = 'nongerminant-unfilled',
no_radical = 'cotyledons only',
week_1 = 'week 1', week_2 = 'week 2', week_3 = 'week 3', week_4 = 'week 4', week_5 = 'week 5', cut_test_performed) %>%
dplyr::mutate(prop_germ = week_5/num_seeds)
####seed fill data
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")%>%
mutate(percentage.filled=((no.seeds.visible-no.seeds.unfilled)/no.seeds.visible))%>%
select(plot, species,no.seeds.visible,no.seeds.unfilled,percentage.filled)
#####calculate the point estiamte and CI for trcy seed fill first
trcy.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Trachymene cyanopetala",])
####plogis back-transform point estimate + and - standard error
trcy.mean.fill<-plogis(3.4534)
trcy.fill.lower.ci<-plogis(3.4534-0.2118)
trcy.fill.upper.ci<-plogis(3.4534+0.2118)
#####calculate the point estiamte and CI for vero seed fill next
vero.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Velleia rosea",])
####plogis back-transform point estimate + and - standard error
vero.mean.fill<-plogis(3.3311)
vero.fill.lower.ci<-plogis(3.3311-0.2343)
vero.fill.upper.ci<-plogis(3.3311+0.2343)
###join fill to germination
trcy_vero<-left_join(trcy_vero, select(trcy_vero_fill,plot, species, percentage.filled,no.seeds.visible,no.seeds.unfilled))
###adjust the number of seeds in petri dishes by plot-specific fill rates
trcy_vero$adjusted.num.seeds=round(trcy_vero$num_seeds*trcy_vero$percentage.filled, digits=0)
#####function to bump up the adjusted seeds if high seed fill in xray conflicted with the adjusted number of seeds in petri dish
trcy_vero$adjusted.num.seeds<-ifelse(with(trcy_vero, adjusted.num.seeds-no_radical-emerged_inviable-week_5)<0, with(trcy_vero, no_radical+emerged_inviable+week_5), trcy_vero$adjusted.num.seeds)
#####first just calculate the proportion of germination in each petri dish
trcy_vero$prop_germ<-trcy_vero$week_5/(trcy_vero$adjusted.num.seeds-trcy_vero$no_radical-trcy_vero$emerged_inviable)
#####just extract the treatment and plot where species germianted best (i.e light or dark for each plot)
higher.germ<-trcy_vero%>%
group_by(plot,species)%>%
slice(which.max(prop_germ))
#####calculate the point estiamte and CI for trcy gemriantion first
trcy.germ<-glmer(cbind(week_5, ((adjusted.num.seeds-no_radical-emerged_inviable)-week_5)) ~1 + (1|plate_number), family=binomial, higher.germ[higher.germ$species=="Trachymene cyanopetala",])
####plogis back-transform point estimate + and - standard error
trcy.mean.germ<-plogis(-0.1025)
trcy.germ.lower.ci<-plogis(-0.1025-0.2442)
trcy.germ.upper.ci<-plogis(-0.1025+0.2442)
#####calculate the point estiamte and CI for vero gemriantion second
vero.germ<-glmer(cbind(week_5, ((adjusted.num.seeds-no_radical-emerged_inviable)-week_5)) ~1 + (1|plate_number), family=binomial, higher.germ[higher.germ$species=="Velleia rosea",])
####plogis back-transform point estimate + and - standard error
vero.mean.germ<-plogis(3.2910)
vero.germ.lower.ci<-plogis(3.2910-0.4407)
vero.germ.upper.ci<-plogis(3.2910+0.4407)
vero.germ
trcy_vero
trcy_vero_fill
trcy.fill
summary(trcy.fill)
trcy.mean.fill<-plogis(3.4534)
trcy.fill.lower.ci<-plogis(3.4534-0.2118)
trcy.fill.upper.ci<-plogis(3.4534+0.2118)
?plogis
trcy.mean.fill
vero.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Velleia rosea",])
####plogis back-transform point estimate + and - standard error
vero.mean.fill<-plogis(3.3311)
vero.fill.lower.ci<-plogis(3.3311-0.2343)
vero.fill.upper.ci<-plogis(3.3311+0.2343)
summary(vero.fill)
trcy_vero<-left_join(trcy_vero, select(trcy_vero_fill,plot, species, percentage.filled,no.seeds.visible,no.seeds.unfilled))
trcy_vero$adjusted.num.seeds=round(trcy_vero$num_seeds*trcy_vero$percentage.filled, digits=0)
trcy.mean.germ
vero.mean.germ
trcy_vero<-read_csv("data/trcy_vero.csv")
head(trcy_vero)
trcy_vero<-read_csv("data/trcy_vero.csv")
trcy_vero
trcy_vero<-read_csv("data/trcy_vero.csv") %>%
dplyr::select(species, plot, light_treatment = `light/ dark`, plate_number = 'plate #',
num_seeds = '# seeds', emerged_inviable = 'emerged-inviable',
nongerm_filled = 'nongerminant-filled', nongerm_unfilled = 'nongerminant-unfilled',
no_radical = 'cotyledons only',
week_1 = 'week 1', week_2 = 'week 2', week_3 = 'week 3', week_4 = 'week 4', week_5 = 'week 5', cut_test_performed) %>%
dplyr::mutate(prop_germ = week_5/num_seeds)
trcy_vero
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")
head(trcy_vero_fill)
trcy_vero_fill
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")
trcy_vero_fill
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")%>%
mutate(percentage.filled=((no.seeds.visible-no.seeds.unfilled)/no.seeds.visible))%>%
select(plot, species,no.seeds.visible,no.seeds.unfilled,percentage.filled)
trcy_vero_fill
cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled))
cbind(trcy_vero_fill$no.seeds.visible- trcy_vero_fill$no.seeds.unfilled, (no.seeds.unfilled))
cbind(trcy_vero_fill$no.seeds.visible- trcy_vero_fill$no.seeds.unfilled, (trcy_vero_fill$no.seeds.unfilled))
trcy.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Trachymene cyanopetala",])
rm(list = ls())
library(tidyverse)
library(lme4)
####bring in germiantion data
trcy_vero<-read_csv("data/trcy_vero.csv") %>%
dplyr::select(species, plot, light_treatment = `light/ dark`, plate_number = 'plate #',
num_seeds = '# seeds', emerged_inviable = 'emerged-inviable',
nongerm_filled = 'nongerminant-filled', nongerm_unfilled = 'nongerminant-unfilled',
no_radical = 'cotyledons only',
week_1 = 'week 1', week_2 = 'week 2', week_3 = 'week 3', week_4 = 'week 4', week_5 = 'week 5', cut_test_performed) %>%
dplyr::mutate(prop_germ = week_5/num_seeds)
####seed fill data
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")%>%
mutate(percentage.filled=((no.seeds.visible-no.seeds.unfilled)/no.seeds.visible))%>%
select(plot, species,no.seeds.visible,no.seeds.unfilled,percentage.filled)
#####calculate the point estiamte and CI for trcy seed fill first
trcy.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Trachymene cyanopetala",])
rm(list = ls())
library(tidyverse)
library(lme4)
####bring in germiantion data
trcy_vero<-read_csv("data/trcy_vero.csv") %>%
dplyr::select(species, plot, light_treatment = `light/ dark`, plate_number = 'plate #',
num_seeds = '# seeds', emerged_inviable = 'emerged-inviable',
nongerm_filled = 'nongerminant-filled', nongerm_unfilled = 'nongerminant-unfilled',
no_radical = 'cotyledons only',
week_1 = 'week 1', week_2 = 'week 2', week_3 = 'week 3', week_4 = 'week 4', week_5 = 'week 5', cut_test_performed) %>%
dplyr::mutate(prop_germ = week_5/num_seeds)
####seed fill data
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")%>%
mutate(percentage.filled=((no.seeds.visible-no.seeds.unfilled)/no.seeds.visible))%>%
select(plot, species,no.seeds.visible,no.seeds.unfilled,percentage.filled)
#####calculate the point estiamte and CI for trcy seed fill first
trcy.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Trachymene cyanopetala",])
rm(list = ls())
library(tidyverse)
library(lme4)
####bring in germiantion data
trcy_vero<-read_csv("data/trcy_vero.csv") %>%
dplyr::select(species, plot, light_treatment = `light/ dark`, plate_number = 'plate #',
num_seeds = '# seeds', emerged_inviable = 'emerged-inviable',
nongerm_filled = 'nongerminant-filled', nongerm_unfilled = 'nongerminant-unfilled',
no_radical = 'cotyledons only',
week_1 = 'week 1', week_2 = 'week 2', week_3 = 'week 3', week_4 = 'week 4', week_5 = 'week 5', cut_test_performed) %>%
dplyr::mutate(prop_germ = week_5/num_seeds)
####seed fill data
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")%>%
mutate(percentage.filled=((no.seeds.visible-no.seeds.unfilled)/no.seeds.visible))%>%
select(plot, species,no.seeds.visible,no.seeds.unfilled,percentage.filled)
#####calculate the point estiamte and CI for trcy seed fill first
trcy.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Trachymene cyanopetala",])
####plogis back-transform point estimate + and - standard error
trcy.mean.fill<-plogis(3.4534)
trcy.fill.lower.ci<-plogis(3.4534-0.2118)
trcy.fill.upper.ci<-plogis(3.4534+0.2118)
#####calculate the point estiamte and CI for vero seed fill next
vero.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Velleia rosea",])
####plogis back-transform point estimate + and - standard error
vero.mean.fill<-plogis(3.3311)
vero.fill.lower.ci<-plogis(3.3311-0.2343)
vero.fill.upper.ci<-plogis(3.3311+0.2343)
###join fill to germination
trcy_vero<-left_join(trcy_vero, select(trcy_vero_fill,plot, species, percentage.filled,no.seeds.visible,no.seeds.unfilled))
###adjust the number of seeds in petri dishes by plot-specific fill rates
trcy_vero$adjusted.num.seeds=round(trcy_vero$num_seeds*trcy_vero$percentage.filled, digits=0)
#####function to bump up the adjusted seeds if high seed fill in xray conflicted with the adjusted number of seeds in petri dish
trcy_vero$adjusted.num.seeds<-ifelse(with(trcy_vero, adjusted.num.seeds-no_radical-emerged_inviable-week_5)<0, with(trcy_vero, no_radical+emerged_inviable+week_5), trcy_vero$adjusted.num.seeds)
#####first just calculate the proportion of germination in each petri dish
trcy_vero$prop_germ<-trcy_vero$week_5/(trcy_vero$adjusted.num.seeds-trcy_vero$no_radical-trcy_vero$emerged_inviable)
#####just extract the treatment and plot where species germianted best (i.e light or dark for each plot)
higher.germ<-trcy_vero%>%
group_by(plot,species)%>%
slice(which.max(prop_germ))
#####calculate the point estiamte and CI for trcy gemriantion first
trcy.germ<-glmer(cbind(week_5, ((adjusted.num.seeds-no_radical-emerged_inviable)-week_5)) ~1 + (1|plate_number), family=binomial, higher.germ[higher.germ$species=="Trachymene cyanopetala",])
####plogis back-transform point estimate + and - standard error
trcy.mean.germ<-plogis(-0.1025)
trcy.germ.lower.ci<-plogis(-0.1025-0.2442)
trcy.germ.upper.ci<-plogis(-0.1025+0.2442)
#####calculate the point estiamte and CI for vero gemriantion second
vero.germ<-glmer(cbind(week_5, ((adjusted.num.seeds-no_radical-emerged_inviable)-week_5)) ~1 + (1|plate_number), family=binomial, higher.germ[higher.germ$species=="Velleia rosea",])
####plogis back-transform point estimate + and - standard error
vero.mean.germ<-plogis(3.2910)
vero.germ.lower.ci<-plogis(3.2910-0.4407)
vero.germ.upper.ci<-plogis(3.2910+0.4407)
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")%>%
mutate(percentage.filled=((no.seeds.visible-no.seeds.unfilled)/no.seeds.visible))%>%
select(plot, species,no.seeds.visible,no.seeds.unfilled,percentage.filled)
data_fill <- read_csv("data/trcy_vero_fill.csv") %>%
mutate(percentage.filled = ((no.seeds.visible - no.seeds.unfilled) / no.seeds.visible)) %>%
select(plot,
species,
no.seeds.visible,
no.seeds.unfilled,
percentage.filled)
data_fill
data_fill
data_fill$species
rm(list = ls())
library(tidyverse)
library(lme4)
####bring in germiantion data
trcy_vero<-read_csv("data/trcy_vero.csv") %>%
dplyr::select(species, plot, light_treatment = `light/ dark`, plate_number = 'plate #',
num_seeds = '# seeds', emerged_inviable = 'emerged-inviable',
nongerm_filled = 'nongerminant-filled', nongerm_unfilled = 'nongerminant-unfilled',
no_radical = 'cotyledons only',
week_1 = 'week 1', week_2 = 'week 2', week_3 = 'week 3', week_4 = 'week 4', week_5 = 'week 5', cut_test_performed) %>%
dplyr::mutate(prop_germ = week_5/num_seeds)
####seed fill data
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")%>%
mutate(percentage.filled=((no.seeds.visible-no.seeds.unfilled)/no.seeds.visible))%>%
select(plot, species,no.seeds.visible,no.seeds.unfilled,percentage.filled)
#####calculate the point estiamte and CI for trcy seed fill first
trcy.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Trachymene cyanopetala",])
####plogis back-transform point estimate + and - standard error
trcy.mean.fill<-plogis(3.4534)
trcy.fill.lower.ci<-plogis(3.4534-0.2118)
trcy.fill.upper.ci<-plogis(3.4534+0.2118)
#####calculate the point estiamte and CI for vero seed fill next
vero.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Velleia rosea",])
summary(vero.fill)
?glmer
data_fill <- read_csv("data/trcy_vero_fill.csv") %>%
mutate(percentage.filled = ((no.seeds.visible - no.seeds.unfilled) / no.seeds.visible)) %>%
select(plot,
species,
no.seeds.visible,
no.seeds.unfilled,
percentage.filled)
trcy_fill <- data_fill %>% filter(species == "Trachymene cyanopetala")
vero_fill <- data_fill %>% filter(species == "Velleia rosea")
trcy_fill_model <- glmer(percentage.filled ~ 1 + (1|plot),
family=binomial
data = trcy.fill)
trcy_fill_model <- glmer(percentage.filled ~ 1 + (1|plot),
family=binomial,
data = trcy.fill)
trcy_fill_model <- glmer( cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled))~ 1 + (1|plot),
family=binomial,
data = trcy.fill)
trcy_fill_model <- glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled))~ 1 + (1|plot),
family=binomial,
data = trcy.fill)
vero_fill_model<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot),
family=binomial,
data = vero_fill)
vero_fill_model
vero_fill_model<-glmer(percentage.filled ~1 + (1|plot),
family=binomial,
data = vero_fill)
vero_fill_model<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot),
family=binomial,
data = vero_fill)
trcy_fill_model<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot),
family=binomial,
data = trcy_fill)
trcy_fill_model<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot),
family=binomial,
data = trcy_fill)
rm(list = ls())
library(tidyverse)
library(lme4)
data_fill <- read_csv("data/trcy_vero_fill.csv") %>%
mutate(percentage.filled = ((no.seeds.visible - no.seeds.unfilled) / no.seeds.visible)) %>%
select(plot,
species,
no.seeds.visible,
no.seeds.unfilled,
percentage.filled)
trcy_fill <- data_fill %>% filter(species == "Trachymene cyanopetala") %>%
vero_fill <- data_fill %>% filter(species == "Velleia rosea")
trcy_fill_model<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot),
family=binomial,
data = trcy_fill)
vero_fill_model<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot),
family=binomial,
data = vero_fill)
rm(list = ls())
library(tidyverse)
library(lme4)
data_fill <- read_csv("data/trcy_vero_fill.csv") %>%
mutate(percentage.filled = ((no.seeds.visible - no.seeds.unfilled) / no.seeds.visible)) %>%
select(plot,
species,
no.seeds.visible,
no.seeds.unfilled,
percentage.filled)
trcy_fill <- data_fill %>% filter(species == "Trachymene cyanopetala")
vero_fill <- data_fill %>% filter(species == "Velleia rosea")
trcy_fill_model<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot),
family=binomial,
data = trcy_fill)
vero_fill_model<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot),
family=binomial,
data = vero_fill)
vero_fill_model
trcy_fill_model
coef(trcy_fill_model)
View(trcy_fill_model)
fixef(trcy_fill_model)
coef(trcy_fill_model)
View(trcy_fill_model)
trcy_fill_model$bcnms
trcy_fill_model$cnms
trcy_fill_model[, cnms]
trcy_fill_model[, "cnms"]
trcy_fill_estimate <- confint(trcy_fill_model)
trcy_fill_estimate
trcy_fill_estimate <- fixef(trcy_fill_model)
trcy_fill_estimate
trcy_fill_estimate <- fixef(trcy_fill_model) %>% plogis()
trcy_fill_estimate
plogis(3.4534)
vero_fill_estimate <- fixef(vero_fill_model) %>% plogis()
vero_fill_estimate
plogis(3.3311)
data_germination <- read_csv("data/trcy_vero.csv") %>%
dplyr::select(
species,
plot,
light_treatment = `light/ dark`,
plate_number = 'plate #',
num_seeds = '# seeds',
emerged_inviable = 'emerged-inviable',
nongerm_filled = 'nongerminant-filled',
nongerm_unfilled = 'nongerminant-unfilled',
no_radical = 'cotyledons only',
week_1 = 'week 1',
week_2 = 'week 2',
week_3 = 'week 3',
week_4 = 'week 4',
week_5 = 'week 5',
cut_test_performed
) %>%
dplyr::mutate(prop_germ = week_5 / num_seeds)
data_germination
data_full <-
left_join(
data_germination,
select(
data_fill,
plot,
species,
percentage.filled,
no.seeds.visible,
no.seeds.unfilled
)
)
data_full
data_full$adjusted.num.seeds=round(data_full$num_seeds*data_full$percentage.filled, digits=0)
rm(list = ls())
library(tidyverse)
library(lme4)
####bring in germiantion data
trcy_vero<-read_csv("data/trcy_vero.csv") %>%
dplyr::select(species, plot, light_treatment = `light/ dark`, plate_number = 'plate #',
num_seeds = '# seeds', emerged_inviable = 'emerged-inviable',
nongerm_filled = 'nongerminant-filled', nongerm_unfilled = 'nongerminant-unfilled',
no_radical = 'cotyledons only',
week_1 = 'week 1', week_2 = 'week 2', week_3 = 'week 3', week_4 = 'week 4', week_5 = 'week 5', cut_test_performed) %>%
dplyr::mutate(prop_germ = week_5/num_seeds)
####seed fill data
trcy_vero_fill<-read_csv("data/trcy_vero_fill.csv")%>%
mutate(percentage.filled=((no.seeds.visible-no.seeds.unfilled)/no.seeds.visible))%>%
select(plot, species,no.seeds.visible,no.seeds.unfilled,percentage.filled)
#####calculate the point estiamte and CI for trcy seed fill first
trcy.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Trachymene cyanopetala",])
####plogis back-transform point estimate + and - standard error
trcy.mean.fill<-plogis(3.4534)
trcy.fill.lower.ci<-plogis(3.4534-0.2118)
trcy.fill.upper.ci<-plogis(3.4534+0.2118)
#####calculate the point estiamte and CI for vero seed fill next
vero.fill<-glmer(cbind(no.seeds.visible-no.seeds.unfilled, (no.seeds.unfilled)) ~1 + (1|plot), family=binomial, trcy_vero_fill[trcy_vero_fill$species=="Velleia rosea",])
####plogis back-transform point estimate + and - standard error
vero.mean.fill<-plogis(3.3311)
vero.fill.lower.ci<-plogis(3.3311-0.2343)
vero.fill.upper.ci<-plogis(3.3311+0.2343)
###join fill to germination
trcy_vero<-left_join(trcy_vero, select(trcy_vero_fill,plot, species, percentage.filled,no.seeds.visible,no.seeds.unfilled))
###adjust the number of seeds in petri dishes by plot-specific fill rates
trcy_vero$adjusted.num.seeds=round(trcy_vero$num_seeds*trcy_vero$percentage.filled, digits=0)
#####function to bump up the adjusted seeds if high seed fill in xray conflicted with the adjusted number of seeds in petri dish
trcy_vero$adjusted.num.seeds<-ifelse(with(trcy_vero, adjusted.num.seeds-no_radical-emerged_inviable-week_5)<0, with(trcy_vero, no_radical+emerged_inviable+week_5), trcy_vero$adjusted.num.seeds)
#####first just calculate the proportion of germination in each petri dish
trcy_vero$prop_germ<-trcy_vero$week_5/(trcy_vero$adjusted.num.seeds-trcy_vero$no_radical-trcy_vero$emerged_inviable)
#####just extract the treatment and plot where species germianted best (i.e light or dark for each plot)
higher.germ<-trcy_vero%>%
group_by(plot,species)%>%
slice(which.max(prop_germ))
#####calculate the point estiamte and CI for trcy gemriantion first
trcy.germ<-glmer(cbind(week_5, ((adjusted.num.seeds-no_radical-emerged_inviable)-week_5)) ~1 + (1|plate_number), family=binomial, higher.germ[higher.germ$species=="Trachymene cyanopetala",])
####plogis back-transform point estimate + and - standard error
trcy.mean.germ<-plogis(-0.1025)
trcy.germ.lower.ci<-plogis(-0.1025-0.2442)
trcy.germ.upper.ci<-plogis(-0.1025+0.2442)
#####calculate the point estiamte and CI for vero gemriantion second
vero.germ<-glmer(cbind(week_5, ((adjusted.num.seeds-no_radical-emerged_inviable)-week_5)) ~1 + (1|plate_number), family=binomial, higher.germ[higher.germ$species=="Velleia rosea",])
####plogis back-transform point estimate + and - standard error
vero.mean.germ<-plogis(3.2910)
vero.germ.lower.ci<-plogis(3.2910-0.4407)
vero.germ.upper.ci<-plogis(3.2910+0.4407)
vero.mean.germ
trcy.mean.germ
trcy.mean.fill
vero.mean.fill
trcy_vero
trcy_vero_fill
trcy_vero_fill
trcy.mean.fill
vero.mean.fill
vero.mean.germ
vero.mean.germ<-plogis(3.2910)
vero.mean.germ
library(readr)
seed_rates <- read_csv("~/Downloads/doi_10.5061_dryad.q41m844__v2/seed_rates.csv")
View(seed_rates)
seed_rates
